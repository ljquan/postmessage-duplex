import{_ as l,c,a as i,b as s,d as t,w as e,e as a,r as o,o as u}from"./app-BZDL3wne.js";const r={};function d(k,n){const p=o("RouteLink");return u(),c("div",null,[n[5]||(n[5]=i(`<h1 id="åœ¨çº¿æ¼”ç¤º" tabindex="-1"><a class="header-anchor" href="#åœ¨çº¿æ¼”ç¤º"><span>åœ¨çº¿æ¼”ç¤º</span></a></h1><p>åœ¨è¿™é‡Œæ‚¨å¯ä»¥ç›´è§‚åœ°ä½“éªŒ postmessage-duplex çš„åŠŸèƒ½ï¼Œæ— éœ€å®‰è£…ä»»ä½•ä¾èµ–ã€‚</p><h2 id="äº¤äº’å¼-playground" tabindex="-1"><a class="header-anchor" href="#äº¤äº’å¼-playground"><span>äº¤äº’å¼ Playground</span></a></h2><div style="margin:20px 0;"><a href="/postmessage-duplex/playground/parent.html" target="_blank" style="display:inline-block;padding:12px 24px;background:#3eaf7c;color:white;border-radius:6px;text-decoration:none;font-weight:500;"> ğŸš€ æ‰“å¼€ Playground </a></div><p>åœ¨ Playground ä¸­ï¼Œæ‚¨å¯ä»¥ï¼š</p><ul><li>âœ… <strong>å‘é€æ¶ˆæ¯</strong> - ä»çˆ¶é¡µé¢å‘å­é¡µé¢å‘é€æ¶ˆæ¯</li><li>âœ… <strong>è¯·æ±‚æ•°æ®</strong> - ä½“éªŒè¯·æ±‚-å“åº”æ¨¡å¼</li><li>âœ… <strong>æµ‹è¯•è¶…æ—¶</strong> - è§‚å¯Ÿè¶…æ—¶å¤„ç†æœºåˆ¶</li><li>âœ… <strong>æŸ¥çœ‹æ—¥å¿—</strong> - å®æ—¶æŸ¥çœ‹é€šè®¯è¿‡ç¨‹</li><li>âœ… <strong>åŒå‘é€šè®¯</strong> - å­é¡µé¢ä¹Ÿå¯ä»¥å‘çˆ¶é¡µé¢å‘é€æ¶ˆæ¯</li></ul><h2 id="å¿«é€Ÿä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#å¿«é€Ÿä½“éªŒ"><span>å¿«é€Ÿä½“éªŒ</span></a></h2><h3 id="åœºæ™¯-1-ç®€å•æ¶ˆæ¯ä¼ é€’" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-1-ç®€å•æ¶ˆæ¯ä¼ é€’"><span>åœºæ™¯ 1ï¼šç®€å•æ¶ˆæ¯ä¼ é€’</span></a></h3><p><strong>çˆ¶é¡µé¢å‘é€æ¶ˆæ¯ï¼š</strong></p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// åˆ›å»ºé€šé“</span></span>
<span class="line"><span class="token keyword">const</span> channel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IframeChannel</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº”</span></span>
<span class="line"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> channel<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&#39;greeting&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> </span>
<span class="line">  message<span class="token operator">:</span> <span class="token string">&#39;Hello!&#39;</span> </span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// { reply: &#39;Hello from child!&#39;, originalMessage: &#39;Hello!&#39; }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å­é¡µé¢æ¥æ”¶å¹¶å“åº”ï¼š</strong></p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// åˆ›å»ºé€šé“</span></span>
<span class="line"><span class="token keyword">const</span> channel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IframeChannel</span><span class="token punctuation">(</span>parentOrigin<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ç›‘å¬æ¶ˆæ¯</span></span>
<span class="line">channel<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;greeting&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ”¶åˆ°:&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>message<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// è¿”å›å“åº”</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> </span>
<span class="line">    reply<span class="token operator">:</span> <span class="token string">&#39;Hello from child!&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    originalMessage<span class="token operator">:</span> data<span class="token punctuation">.</span>message </span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åœºæ™¯-2-è¯·æ±‚æ•°æ®" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-2-è¯·æ±‚æ•°æ®"><span>åœºæ™¯ 2ï¼šè¯·æ±‚æ•°æ®</span></a></h3><p><strong>çˆ¶é¡µé¢è¯·æ±‚æ•°æ®ï¼š</strong></p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// è¯·æ±‚ç”¨æˆ·ä¿¡æ¯</span></span>
<span class="line"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> channel<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&#39;getUserInfo&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> </span>
<span class="line">  userId<span class="token operator">:</span> <span class="token number">123</span> </span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ret <span class="token operator">===</span> ReturnCode<span class="token punctuation">.</span>Success<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;ç”¨æˆ·ä¿¡æ¯:&#39;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// { id: 123, name: &#39;John&#39;, email: &#39;john@example.com&#39; }</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å­é¡µé¢å¤„ç†è¯·æ±‚ï¼š</strong></p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line">channel<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;getUserInfo&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ä»æ•°æ®åº“è·å–ç”¨æˆ·</span></span>
<span class="line">  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUser</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>userId<span class="token punctuation">)</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// è¿”å›ç”¨æˆ·ä¿¡æ¯</span></span>
<span class="line">  <span class="token keyword">return</span> user</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åœºæ™¯-3-åŒå‘é€šè®¯" tabindex="-1"><a class="header-anchor" href="#åœºæ™¯-3-åŒå‘é€šè®¯"><span>åœºæ™¯ 3ï¼šåŒå‘é€šè®¯</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token comment">// çˆ¶é¡µé¢ç›‘å¬å­é¡µé¢é€šçŸ¥</span></span>
<span class="line">channel<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;notification&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">showToast</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> received<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å­é¡µé¢ä¸»åŠ¨å‘é€é€šçŸ¥</span></span>
<span class="line">channel<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&#39;notification&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> </span>
<span class="line">  type<span class="token operator">:</span> <span class="token string">&#39;success&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  message<span class="token operator">:</span> <span class="token string">&#39;æ“ä½œå®Œæˆï¼&#39;</span> </span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åœ¨æœ¬åœ°è¿è¡Œ-demo" tabindex="-1"><a class="header-anchor" href="#åœ¨æœ¬åœ°è¿è¡Œ-demo"><span>åœ¨æœ¬åœ°è¿è¡Œ Demo</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># å…‹éš†ä»“åº“</span></span>
<span class="line"><span class="token function">git</span> clone https://github.com/ljquan/postmessage-duplex.git</span>
<span class="line"><span class="token builtin class-name">cd</span> postmessage-duplex</span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®‰è£…ä¾èµ–</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span></span>
<span class="line"><span class="token function">npm</span> run dev</span>
<span class="line"></span>
<span class="line"><span class="token comment"># è®¿é—® Demo</span></span>
<span class="line"><span class="token function">open</span> http://localhost:7100/demo/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="demo-ç›®å½•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#demo-ç›®å½•ç»“æ„"><span>Demo ç›®å½•ç»“æ„</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">demo/</span>
<span class="line">â”œâ”€â”€ iframe/              # iframe é€šè®¯ç¤ºä¾‹</span>
<span class="line">â”‚   â”œâ”€â”€ index.html       # çˆ¶é¡µé¢</span>
<span class="line">â”‚   â””â”€â”€ child.html       # å­é¡µé¢</span>
<span class="line">â”œâ”€â”€ service-worker/      # Service Worker ç¤ºä¾‹</span>
<span class="line">â”‚   â”œâ”€â”€ index.html       # ä¸»é¡µé¢</span>
<span class="line">â”‚   â””â”€â”€ sw.js            # Service Worker</span>
<span class="line">â””â”€â”€ debugger/            # è°ƒè¯•å·¥å…·</span>
<span class="line">    â”œâ”€â”€ index.html       # è°ƒè¯•å™¨ä¸»é¡µ</span>
<span class="line">    â””â”€â”€ child.html       # è¢«è°ƒè¯•é¡µé¢</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»£ç ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ä»£ç ç¤ºä¾‹"><span>ä»£ç ç¤ºä¾‹</span></a></h2><h3 id="å®Œæ•´çš„çˆ¶é¡µé¢ä»£ç " tabindex="-1"><a class="header-anchor" href="#å®Œæ•´çš„çˆ¶é¡µé¢ä»£ç "><span>å®Œæ•´çš„çˆ¶é¡µé¢ä»£ç </span></a></h3><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>çˆ¶é¡µé¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>child<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./child.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendBtn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å‘é€æ¶ˆæ¯<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  </span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line">    <span class="token keyword">import</span> <span class="token punctuation">{</span> IframeChannel<span class="token punctuation">,</span> ReturnCode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;postmessage-duplex&#39;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;child&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> channel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IframeChannel</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// ç›‘å¬å­é¡µé¢æ¶ˆæ¯</span></span>
<span class="line">    channel<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;notification&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ”¶åˆ°é€šçŸ¥:&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">acknowledged</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// å‘é€æ¶ˆæ¯</span></span>
<span class="line">    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;sendBtn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> channel<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&#39;getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      </span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ret <span class="token operator">===</span> ReturnCode<span class="token punctuation">.</span>Success<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ•°æ®:&#39;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;é”™è¯¯:&#39;</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>msg<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// æ¸…ç†</span></span>
<span class="line">    window<span class="token punctuation">.</span><span class="token function-variable function">onbeforeunload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> channel<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®Œæ•´çš„å­é¡µé¢ä»£ç " tabindex="-1"><a class="header-anchor" href="#å®Œæ•´çš„å­é¡µé¢ä»£ç "><span>å®Œæ•´çš„å­é¡µé¢ä»£ç </span></a></h3><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code class="language-html"><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>å­é¡µé¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>notifyBtn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é€šçŸ¥çˆ¶é¡µé¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  </span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line">    <span class="token keyword">import</span> <span class="token punctuation">{</span> IframeChannel <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;postmessage-duplex&#39;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// ä¼ å…¥çˆ¶é¡µé¢ origin</span></span>
<span class="line">    <span class="token keyword">const</span> channel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IframeChannel</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>origin<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// å¤„ç†æ•°æ®è¯·æ±‚</span></span>
<span class="line">    channel<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">&#39;getData&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">id</span><span class="token operator">:</span> data<span class="token punctuation">.</span>id<span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;Item &#39;</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>id<span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">99.99</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">// å‘é€é€šçŸ¥</span></span>
<span class="line">    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;notifyBtn&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">await</span> channel<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&#39;notification&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;info&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;Hello from child!&#39;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¸‹ä¸€æ­¥" tabindex="-1"><a class="header-anchor" href="#ä¸‹ä¸€æ­¥"><span>ä¸‹ä¸€æ­¥</span></a></h2>`,29)),s("ul",null,[s("li",null,[t(p,{to:"/guide/getting-started.html"},{default:e(()=>[...n[0]||(n[0]=[a("å¿«é€Ÿå¼€å§‹",-1)])]),_:1}),n[1]||(n[1]=a(" - è¯¦ç»†çš„å…¥é—¨æŒ‡å—",-1))]),n[4]||(n[4]=s("li",null,[s("a",{href:"/api/",target:"_blank",rel:"noopener noreferrer"},"API æ–‡æ¡£"),a(" - å®Œæ•´çš„ API å‚è€ƒ")],-1)),s("li",null,[t(p,{to:"/examples/vue.html"},{default:e(()=>[...n[2]||(n[2]=[a("Vue/React é›†æˆ",-1)])]),_:1}),n[3]||(n[3]=a(" - æ¡†æ¶é›†æˆç¤ºä¾‹",-1))])])])}const v=l(r,[["render",d]]),g=JSON.parse('{"path":"/playground/","title":"åœ¨çº¿æ¼”ç¤º","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1769418463000,"contributors":[{"name":"liquidliang","username":"liquidliang","email":"ljquan@qq.com","commits":1,"url":"https://github.com/liquidliang"}],"changelog":[{"hash":"288e378422593e39667c397bec9bbbf25465b67a","time":1769418463000,"email":"ljquan@qq.com","author":"liquidliang","message":"init"}]},"filePathRelative":"playground/README.md"}');export{v as comp,g as data};
